From 2d6f6af423c9eeb5ca4b7c2394ba0a78a730be4a Mon Sep 17 00:00:00 2001
From: Christophe Priouzeau <christophe.priouzeau@st.com>
Date: Wed, 29 Aug 2018 14:29:58 +0200
Subject: [PATCH] add GNU_HASH in the elf binary

---
 daemons/gptp/linux/build/Makefile | 2 +-
 examples/jackd-listener/Makefile  | 2 +-
 examples/simple_listener/Makefile | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/daemons/gptp/linux/build/Makefile b/daemons/gptp/linux/build/Makefile
index 1e00b1a..c64aeb2 100644
--- a/daemons/gptp/linux/build/Makefile
+++ b/daemons/gptp/linux/build/Makefile
@@ -47,7 +47,7 @@ ifeq ($(HAS_PRECISE_TIME),0)
 endif
 
 CPPFLAGS_G = $(CFLAGS_G) -std=c++0x -Wnon-virtual-dtor
-LDFLAGS_G = 
+LDFLAGS_G = -Wl,--hash-style=gnu
 
 COMMON_DIR = ../../common
 SRC_DIR = ../src
diff --git a/examples/jackd-listener/Makefile b/examples/jackd-listener/Makefile
index 4a526b9..a954912 100644
--- a/examples/jackd-listener/Makefile
+++ b/examples/jackd-listener/Makefile
@@ -9,7 +9,7 @@ OPT = -O2 -g
 WARN = -Wall -Wextra -Wno-parentheses
 CFLAGS = $(OPT) $(WARN) -std=gnu99
 CPPFLAGS = -I$(DAEMONS_DIR)/mrpd -I$(MRPCLIENT_DIR) -I$(DAEMONS_DIR)/common
-LDLIBS = -lpcap -lsndfile -ljack -lpthread
+LDLIBS = -lpcap -lsndfile -ljack -lpthread -Wl,--hash-style=gnu
 
 all: jack_listener
 
diff --git a/examples/simple_listener/Makefile b/examples/simple_listener/Makefile
index 02d66fa..dc2010e 100644
--- a/examples/simple_listener/Makefile
+++ b/examples/simple_listener/Makefile
@@ -9,7 +9,7 @@ OPT = -O2 -g
 WARN=-Wall -Wextra -Wno-parentheses
 CFLAGS=$(OPT) $(WARN)
 CPPFLAGS = -I$(DAEMONS_DIR)/mrpd -I$(MRPCLIENT_DIR) -I$(DAEMONS_DIR)/common
-LDLIBS = -lpcap -lsndfile -pthread
+LDLIBS = -lpcap -lsndfile -pthread -Wl,--hash-style=gnu
 
 all: simple_listener
 
-- 
2.7.4

